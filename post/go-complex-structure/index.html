<!doctype html><html lang=zh-hans><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.100.2"><link rel=apple-touch-icon sizes=180x180 href=/img/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/img/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/img/favicon-16x16.png><link rel=manifest href=/img/site.webmanifest><link rel=mask-icon href=/img/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>Go复杂数据结构 - 赵海宇的博客</title><meta name=author content="haiyux"><meta name=description content="欢迎来到haiyux的博客"><meta name=keywords content="golang"><meta property="og:title" content="Go复杂数据结构"><meta name=twitter:title content="Go复杂数据结构"><meta property="og:type" content="article"><meta property="og:url" content="https://www.zhaohaiyu.com/post/go-complex-structure/"><meta property="og:description" content="数组 数组是一个由固定长度的特定类型元素组成的序列，一个数组可以由零个或多个元素组成。 因为数组的长度是固定的，因此在Go语言中很少直接使用数组。 数组的每个元素可以通过索引下标来访问，索引下标的范围是从0"><meta name=twitter:description content="数组 数组是一个由固定长度的特定类型元素组成的序列，一个数组可以由零个或多个元素组成。 因为数组的长度是固定的，因此在Go语言中很少直接使用数组。 数组的每个元素可以通过索引下标来访问，索引下标的范围是从0"><meta property="og:image" content="https://www.zhaohaiyu.com/img/favicon-32x32.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.zhaohaiyu.com/img/favicon-32x32.png"><meta property="article:published_time" content="2019-01-28T20:38:18+08:00"><meta property="article:modified_time" content="2019-01-28T20:38:18+08:00"><style>@media(prefers-color-scheme:dark){body[data-theme=auto] img{filter:brightness(60%)}}body[data-theme=dark] img{filter:brightness(60%)}</style><link rel=stylesheet href=https://www.zhaohaiyu.com/assets/css/fuji.min.css></head><body data-theme=auto data-theme-auto=true><script data-cfasync=false>var fujiThemeData=localStorage.getItem('fuji_data-theme');fujiThemeData?fujiThemeData!=='auto'&&document.body.setAttribute('data-theme',fujiThemeData==='dark'?'dark':'light'):localStorage.setItem('fuji_data-theme','auto')</script><header><div class="container-lg clearfix"><div class="col-12 header"><a class=title-main href=https://www.zhaohaiyu.com>赵海宇的博客</a>
<span class=title-sub>路漫漫其修远兮,吾将上下而求索。</span></div></div></header><main><div class="container-lg clearfix"><div class="col-12 col-md-9 float-left content"><article><h2 class="post-item post-title"><a href=https://www.zhaohaiyu.com/post/go-complex-structure/>Go复杂数据结构</a></h2><div class="post-item post-meta"><span><i class="iconfont icon-today-sharp"></i>&nbsp;2019-01-28</span>
<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;2170 字</span>
<span><i class="iconfont icon-time-sharp"></i>&nbsp;5 分钟</span>
<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href=/tags/golang>golang</a>&nbsp;</span></div><div class="post-content markdown-body"><h2 id=数组>数组</h2><p><strong>数组是一个由固定长度的特定类型元素组成的序列，一个数组可以由零个或多个元素组成。</strong> 因为数组的长度是固定的，因此在Go语言中很少直接使用数组。</p><p>数组的每个元素可以通过索引下标来访问，索引下标的范围是从0开始到数组长度减1的位置。内置的len函数将返回数组中元素的个数。</p><pre><code class=language-go>var a [3]int             // 长度为3的数组
fmt.Println(a[0])        // 打印第一个数据
fmt.Println(a[len(a)-1]) // 打印最后一个数据
for i, v := range a {
    fmt.Printf(&quot;%d %d\n&quot;, i, v) // 循环数组 i为索引 v为数据
}
</code></pre><p><strong>默认情况下，数组的每个元素都被初始化为元素类型对应的零值</strong></p><p>数组的初始化:</p><pre><code class=language-go>var a [3]int = [3]int{1, 2, 3}
b := [...]int{1, 2, 3}
a = [4]int{1, 2, 3, 4} // panic 数据初始化就是定长了  长度不能变化
</code></pre><h2 id=切片>切片</h2><p>Slice（切片）代表变长的序列，序列中每个元素都有相同的类型。一个slice类型一般写作[]T，其中T代表slice中元素的类型；slice的语法和数组很像，只是没有固定长度而已。</p><p><strong>一个slice由三个部分构成：指针、长度和容量</strong>。指针指向第一个slice元素对应的底层数组元素的地址，要注意的是slice的第一个元素并不一定就是数组的第一个元素。长度对应slice中元素的数目；长度不能超过容量，容量一般是从slice的开始位置到底层数据的结尾位置。内置的len和cap函数分别返回slice的长度和容量。</p><p>多个slice之间可以共享底层的数据，并且引用的数组部分区间可能重叠。</p><p><strong>使用make()函数构造切片</strong></p><pre><code class=language-go>make([]T, size, cap)   // T:切片类型  size 切片数量  cap 切片容量
</code></pre><p><strong>append()方法为切片添加元素</strong></p><pre><code class=language-go>sli := make([]int,0,10)
sli = append(sli,1)	 // 添加一个 1
arr := [4]int{6,7,8,9}
sli = append(sle,arr...) // 把arr打散并全部添加  添加多个
fmt.Println(sli)    // [1 6 7 8 9]
</code></pre><p><strong>从切片中删除元素</strong></p><pre><code class=language-go>// 从切片中删除元素
a := []int{30, 31, 32, 33, 34, 35, 36, 37}
// 要删除索引为2的元素
a = append(a[:2], a[3:]...)
fmt.Println(a) //[30 31 33 34 35 36 37]
</code></pre><p><strong>切片的扩容策略</strong></p><pre><code class=language-go>func growslice(et *_type, old slice, cap int) slice {
	newcap := old.cap
	doublecap := newcap + newcap
	if cap &gt; doublecap {
		newcap = cap
	} else {
		if old.len &lt; 1024 {
			newcap = doublecap
		} else {
			for 0 &lt; newcap &amp;&amp; newcap &lt; cap {
				newcap += newcap / 4
			}
			if newcap &lt;= 0 {
				newcap = cap
			}
		}
	}
</code></pre><p>在分配内存空间之前需要先确定新的切片容量，Go 语言根据切片的当前容量选择不同的策略进行扩容：</p><ol><li>如果期望容量大于当前容量的两倍就会使用期望容量；</li><li>如果当前切片容量小于 1024 就会将容量翻倍；</li><li>如果当前切片容量大于 1024 就会每次增加 25% 的容量，直到新容量大于期望容量；</li></ol><h2 id=map>MAP</h2><p>哈希表是一种巧妙并且实用的数据结构。它是一个<strong>无序的key/value对的集合</strong>，其中所有的key都是不同的，然后通过给定的key可以在常数时间复杂度内检索、更新或删除对应的value。在Go语言中，一个map就是一个哈希表的引用，map类型可以写为map[K]V，其中K和V分别对应key和value。</p><ul><li>初始化:</li></ul><pre><code class=language-go>m := make(map[string]int)
</code></pre><ul><li>赋值初始化</li></ul><pre><code class=language-go>m := map[string]int{
    &quot;zhy&quot;:   18,
    &quot;who&quot;: 30,
}
// 直接赋值相当于
ages := make(map[string]int)
ages[&quot;zhy&quot;] = 18
ages[&quot;who&quot;] = 30
</code></pre><p>**Map的迭代顺序是不确定的，并且不同的哈希函数实现可能导致不同的遍历顺序。**遍历的顺序是随机的，每一次遍历的顺序都不相同。</p><p>如果要有序:</p><pre><code class=language-go>// 用sort进项排序
var names []string
for name := range ages {
    names = append(names, name)
}
sort.Strings(names)
for _, name := range names {
    fmt.Printf(&quot;%s\t%d\n&quot;, name, ages[name])
}
</code></pre><h2 id=结构体>结构体</h2><p><strong>结构体是一种聚合的数据类型，是由零个或多个任意类型的值聚合成的实体。每个值称为结构体的成员。</strong></p><pre><code class=language-go>type people struct {
    name string
    age uint8
    hobby []string
    address string 
    sex uint8
}
var zhy people
</code></pre><p><strong>结构体赋值</strong></p><pre><code class=language-go>h := []string{&quot;唱&quot;,&quot;跳&quot;,&quot;RAP&quot;,&quot;篮球&quot;}
zhy := people{&quot;zhaohaiyu&quot;,18,h,&quot;地球&quot;,1}
</code></pre><p>或者</p><pre><code class=language-go>var zhy people
zhy.name = &quot;zhaohaiyu&quot;
zhy.age = 18
zhy.hobby = h
zhy.address = &quot;地球&quot;
zhy.sex = 1
</code></pre><h3 id=结构体比较>结构体比较</h3><p>如果结构体的全部成员都是可以比较的，那么结构体也是可以比较的，那样的话两个结构体将可以使用或!=运算符进行比较。相等比较运算符将比较两个结构体的每个成员，因此下面两个比较的表达式是等价的：</p><pre><code class=language-go>type Point struct{ X, Y int }
p := Point{1, 2}
q := Point{2, 1}
fmt.Println(p.X == q.X &amp;&amp; p.Y == q.Y) // &quot;false&quot;
fmt.Println(p == q)                   // &quot;false&quot;
</code></pre><h3 id=结构体的继承>结构体的继承</h3><p>在java,python,cpp等语言中都有类的继承的概念,go语言中没有类.用结构体的嵌套实现继承.</p><pre><code class=language-go>type animal struct {
    name string
    age int
}
type people struct {
    address string
    animal animal
}
var zhy = people{
    address: &quot;地球&quot;,
    animal:  animal{
        name: &quot;zhaohaiyu&quot;,
        age:  18,
    },
}
fmt.Println(zhy.animal)  // {zhaohaiyu 18}
fmt.Println(zhy.animal.name) // zhaohaiyu
fmt.Println(zhy.animal.age)  // 18
fmt.Println(zhy.address) //地球
</code></pre><h2 id=json>JSON</h2><p>JSON(JavaScript Object Notation, JS 对象简谱) 是一种轻量级的数据交换格式。它基于ECMAScript(欧洲计算机协会制定的js规范)的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。</p><p>Go语言对于这些标准格式的编码和解码都有良好的支持，由标准库中的<strong>encoding/json</strong>包提供支持</p><p>JSON是对JavaScript中各种类型的值——字符串、数字、布尔值和对象——Unicode本文编码。它可以用有效可读的方式表示第三章的基础数据类型和本章的数组、slice、结构体和map等聚合数据类型。</p><ul><li>各类型的json数据</li></ul><pre><code class=language-go>boolean         true
number          -273.15
string          &quot;hello world!!!!&quot;
array           [&quot;i&quot;, &quot;you&quot;, &quot;her&quot;]
object          {&quot;year&quot;: 2020,
                 &quot;event&quot;:&quot;huawei&quot;,&quot;American virus&quot;,&quot;Trump is crazy&quot;}
</code></pre><ul><li>go语言结构体成员Tag来指定对应的JSON名字。同样，在解码的时候也需要做同样的处理</li></ul><pre><code class=language-go>type People struct {
    Name string `json:&quot;name&quot;`
    Age int `json:&quot;age&quot;`
    PhoneNumber string `json:&quot;phone_number&quot;`
}
</code></pre><ul><li>要将结构体的数据发给游览器前端或者安卓,IOS,APP等进行展示,因为go语言首字母小写只能本包用,在外部包要首字母大写,包括结构体和结构体成员.而且go语言崇尚驼峰体命名,而很多语言崇尚下划线命名.所有我们要用tag把json数据的成员变成首字母小写以及下划线命名.</li></ul></div></article><div class="license markdown-body"><blockquote><p>除特殊注明部分，本站内容采用 <a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a> 进行许可。</p></blockquote></div><div class=post-comment data-comment=utterances><span class=post-comment-notloaded><i class="iconfont icon-chatbox-ellipses-sharp"></i>&nbsp;查看评论</span>
<script>function loadComment(){var e,n=document.querySelector('.post-comment'),t=document.body.getAttribute('data-theme');t==='auto'?t=window.matchMedia('(prefers-color-scheme: dark)').matches?'photon-dark':'github-light':t=t==='dark'?'photon-dark':'github-light',e=document.createElement('script'),e.src='https://utteranc.es/client.js',e.setAttribute('repo','haiyux/haiyux.github.io'),e.setAttribute('issue-term','pathname'),e.setAttribute('theme',t),e.setAttribute('crossorigin','anonymous'),e.setAttribute('async',''),document.querySelector('.post-comment').appendChild(e),document.querySelector('span.post-comment-notloaded').setAttribute('style','display: none;')}</script></div></div><aside class="col-12 col-md-3 float-left sidebar"><div class="sidebar-item sidebar-pages"><h3>页面</h3><ul><li><a href=/>主页</a></li><li><a href=/archives/>文章</a></li><li><a href=/about/>关于</a></li><li><a href=/search/>搜索</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>链接</h3><ul><li><a href=https://github.com/haiyux target=_blank><span>GitHub</span></a></li><li><a href=https://go-kratos.dev target=_blank><span>Kratos</span></a></li><li><a href=mailto:haiyux@foxmail.com target=_blank><span>Email</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>标签</h3><div><span><a href=/tags/ddd/>DDD</a></span>
<span><a href=/tags/docker/>docker</a></span>
<span><a href=/tags/golang/>golang</a></span>
<span><a href=/tags/grpc/>grpc</a></span>
<span><a href=/tags/http/>http</a></span>
<span><a href=/tags/kratos/>kratos</a></span>
<span><a href=/tags/makefile/>makefile</a></span>
<span><a href=/tags/mq/>mq</a></span>
<span><a href=/tags/mysql/>mysql</a></span>
<span><a href=/tags/nginx/>nginx</a></span>
<span><a href=/tags/protobuf/>protobuf</a></span>
<span><a href=/tags/raft/>raft</a></span>
<span><a href=/tags/redis/>redis</a></span>
<span><a href=/tags/thrift/>Thrift</a></span>
<span><a href=/tags/traceing/>traceing</a></span>
<span><a href=/tags/wire/>wire</a></span>
<span><a href=/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/>微服务</a></span>
<span><a href=/tags/%E6%B3%9B%E5%9E%8B/>泛型</a></span>
<span><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/>设计模式</a></span>
<span><a href=/tags/%E8%BF%90%E7%BB%B4/>运维</a></span></div></div><div class="sidebar-item sidebar-toc"><h3>目录</h3><nav id=TableOfContents><ul><li><a href=#数组>数组</a></li><li><a href=#切片>切片</a></li><li><a href=#map>MAP</a></li><li><a href=#结构体>结构体</a><ul><li><a href=#结构体比较>结构体比较</a></li><li><a href=#结构体的继承>结构体的继承</a></li></ul></li><li><a href=#json>JSON</a></li></ul></nav></div></aside></div><div class=btn><div class=btn-menu id=btn-menu><i class="iconfont icon-grid-sharp"></i></div><div class=btn-toggle-mode><i class="iconfont icon-contrast-sharp"></i></div><div class=btn-scroll-top><i class="iconfont icon-chevron-up-circle-sharp"></i></div></div><aside class=sidebar-mobile style=display:none><div class=sidebar-wrapper><div class="sidebar-item sidebar-pages"><h3>页面</h3><ul><li><a href=/>主页</a></li><li><a href=/archives/>文章</a></li><li><a href=/about/>关于</a></li><li><a href=/search/>搜索</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>链接</h3><ul><li><a href=https://github.com/haiyux target=_blank><span>GitHub</span></a></li><li><a href=https://go-kratos.dev target=_blank><span>Kratos</span></a></li><li><a href=mailto:haiyux@foxmail.com target=_blank><span>Email</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>标签</h3><div><span><a href=/tags/ddd/>DDD</a></span>
<span><a href=/tags/docker/>docker</a></span>
<span><a href=/tags/golang/>golang</a></span>
<span><a href=/tags/grpc/>grpc</a></span>
<span><a href=/tags/http/>http</a></span>
<span><a href=/tags/kratos/>kratos</a></span>
<span><a href=/tags/makefile/>makefile</a></span>
<span><a href=/tags/mq/>mq</a></span>
<span><a href=/tags/mysql/>mysql</a></span>
<span><a href=/tags/nginx/>nginx</a></span>
<span><a href=/tags/protobuf/>protobuf</a></span>
<span><a href=/tags/raft/>raft</a></span>
<span><a href=/tags/redis/>redis</a></span>
<span><a href=/tags/thrift/>Thrift</a></span>
<span><a href=/tags/traceing/>traceing</a></span>
<span><a href=/tags/wire/>wire</a></span>
<span><a href=/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/>微服务</a></span>
<span><a href=/tags/%E6%B3%9B%E5%9E%8B/>泛型</a></span>
<span><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/>设计模式</a></span>
<span><a href=/tags/%E8%BF%90%E7%BB%B4/>运维</a></span></div></div><div class="sidebar-item sidebar-toc"><h3>目录</h3><nav id=TableOfContents><ul><li><a href=#数组>数组</a></li><li><a href=#切片>切片</a></li><li><a href=#map>MAP</a></li><li><a href=#结构体>结构体</a><ul><li><a href=#结构体比较>结构体比较</a></li><li><a href=#结构体的继承>结构体的继承</a></li></ul></li><li><a href=#json>JSON</a></li></ul></nav></div></div></aside></main><footer><div class="container-lg clearfix"><div class="col-12 footer"><span>&copy; 2019-2022
<a href=https://www.zhaohaiyu.com>haiyux</a>
| <a href=https://github.com/haiyux/haiyu.github.io>Source code</a>
| 基于 <a href=https://github.com/dsrkafuu/hugo-theme-fuji/ target=_blank>Fuji-v2</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a> 构建</span></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.27.0/components/prism-core.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.27.0/plugins/autoloader/prism-autoloader.min.js></script>
<script defer src=/assets/js/fuji.min.js></script></body></html>